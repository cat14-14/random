<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>자리 뽑기</title>
  <link rel="icon" href="icon.png" type="image/png">
  <style>
    * { box-sizing: border-box; transition: all 0.3s ease; }
    body {
      font-family: 'Noto Sans KR', sans-serif;
      margin: 0;
      background: linear-gradient(to bottom, #e0f2fe, #dbeafe);
      overflow-x: hidden;
    }
    .container {
      max-width: 1000px;
      margin: 100px auto;
      padding: 50px ;
      border-radius: 20px;
      background: white;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }
    h1 { text-align: center; color: #1d4ed8; }
    label { font-weight: bold; display: block; color: #374151; margin-top: 20px; }
    input, button {
      width: 100%; padding: 10px; margin-top: 5px;
      border-radius: 10px; font-size: 16px;
    }
    button {
      background: #6366f1; color: white; border: none; font-weight: bold; margin-top: 15px;
    }
    button:active { transform: scale(0.97); }
    .mode-selector {
  display: flex;
  flex-wrap: wrap;
  justify-content: center; /* 가운데 정렬 */
  gap: 10px;
  margin-bottom: 15px;
}

.mode-selector button {
  flex: 1 1 auto;
  min-width: 120px;
  max-width: 160px;
}


    .group {
      background: #f3f4f6; padding: 15px; margin-bottom: 15px;
      border-left: 5px solid #6366f1; border-radius: 10px;
    }
    .group strong {
      color: #4f46e5; display: block; margin-bottom: 5px;
    }
    .group span {
      display: inline-block; margin: 4px; padding: 6px 10px;
      background: #e0e7ff; border-radius: 8px;
    }
    .group span:hover {
      background: #c7d2fe; transform: scale(1.1);
    }
    .result {
  margin-top: 20px;
  display: flex;
  flex-wrap: wrap;
  gap: 15px;
  justify-content: space-between;
}
.group {
  width: 48%; /* 2개씩 정렬되도록 반반 너비 */
}

    .hidden { display: none; }
    #wheelWrapper {
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 20px;
    }
    #wheelCanvas {
      margin-top: 40px;
      border-radius: 50%;
    }
    .pointer {
      width: 0;
      height: 0;
      border-left: 20px solid transparent;
      border-right: 20px solid transparent;
      border-top: 30px solid red;
      position: absolute;
      top: 15px;
      z-index: 10;
    }
    #wheelResult {
      text-align: center;
      font-size: 20px;
      font-weight: bold;
      color: #1d4ed8;
      margin-top: 15px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="lang-switch">
      <button onclick="setLanguage('ko')">🇰🇷</button>
      <button onclick="setLanguage('en')">🇺🇸</button>
    </div>
    <h1 id="title">자리 뽑기</h1>
    <div class="mode-selector">
      <button id="btnName" onclick="setMode('name')">이름으로 뽑기</button>
      <button id="btnNumber" onclick="setMode('number')">번호로 뽑기</button>
      <button id="btnLotto" onclick="setMode('lotto')">제비뽑기</button>
      <button id="btnWheel" onclick="setMode('wheel')">돌림판</button>
      <button id="btnRange" onclick="setMode('range')">범위별 랜덤 조</button>
    </div>

    <div id="nameMode">
      <label id="lblNames">이름 목록 (쉼표로 구분)</label>
      <input type="text" id="names" placeholder="예: 철수, 영희, 민수">
      <label id="lblGroupCountName">모둠 수</label>
      <input type="number" id="groupCountName" placeholder="예: 3">
      <button id="btnDrawByName" onclick="drawByName()">이름 모둠 뽑기</button>
    </div>

    <div id="numberMode" class="hidden">
      <label id="lblCount">총 인원 수</label>
      <input type="number" id="count" placeholder="예: 10">
      <label id="lblGroupCount">모둠 수</label>
      <input type="number" id="groupCount" placeholder="예: 3">
      <button id="btnDrawByNumber" onclick="drawByNumber()">번호 모둠 뽑기</button>
    </div>

    <div id="lottoMode" class="hidden">
      <label id="lblLottoCount">제비뽑기 대상 수</label>
      <input type="number" id="lottoCount" placeholder="예: 10">
      <label id="lblLottoDraw">몇 명을 뽑을까요?</label>
      <input type="number" id="lottoDraw" placeholder="예: 2">
      <button id="btnDrawLotto" onclick="drawLotto()">제비 뽑기</button>
    </div>

    <div id="wheelMode" class="hidden">
      <label id="lblWheelInput">대상 이름 (쉼표로 구분) 또는 숫자 개수</label>
      <input type="text" id="wheelInput" placeholder="예: 철수, 영희 또는 10" oninput="parseWheelInput()">
      <button id="btnSpinWheel" onclick="spinWheel()">🎡 돌리기</button>
      <div id="wheelWrapper">
        <div class="pointer"></div>
        <canvas id="wheelCanvas" width="300" height="300"></canvas>
      </div>
      <div id="wheelResult"></div>
    </div>

    <div id="rangeMode" class="hidden">
      <label id="lblTotalCount">총 인원 수</label>
      <input type="number" id="totalCount" placeholder="예: 17">
      <label id="lblRangeGroupCount">모둠 수</label>
      <input type="number" id="rangeGroupCount" placeholder="예: 8">
      <label id="lblRangeOne">범위1 (예: 1-8)</label>
      <input type="text" id="rangeOne" placeholder="1-8">
      <label id="lblRangeTwo">범위2 (예: 9-17)</label>
      <input type="text" id="rangeTwo" placeholder="9-17">
      <button id="btnDrawByRange" onclick="drawByRange()">범위별 랜덤 조 뽑기</button>
    </div>

    <button id="btnClear" onclick="clearResult()">결과 초기화</button>
    <div id="result" class="result"></div>
  </div>

<script>
const translations = {
  ko: {
    title: "자리 뽑기",
    btnName: "이름으로 뽑기",
    btnNumber: "번호로 뽑기",
    btnLotto: "제비뽑기",
    btnWheel: "돌림판",
    btnRange: "범위별 랜덤 조",
    lblNames: "이름 목록 (쉼표로 구분)",
    lblGroupCountName: "모둠 수",
    btnDrawByName: "이름 모둠 뽑기",
    lblCount: "총 인원 수",
    lblGroupCount: "모둠 수",
    btnDrawByNumber: "번호 모둠 뽑기",
    lblLottoCount: "제비뽑기 대상 수",
    lblLottoDraw: "몇 명을 뽑을까요?",
    btnDrawLotto: "제비 뽑기",
    lblWheelInput: "대상 이름 (쉼표로 구분) 또는 숫자 개수",
    btnSpinWheel: "🎡 돌리기",
    lblTotalCount: "총 인원 수",
    lblRangeGroupCount: "모둠 수",
    lblRangeOne: "범위1 (예: 1-8)",
    lblRangeTwo: "범위2 (예: 9-17)",
    btnDrawByRange: "범위별 랜덤 조 뽑기",
    btnClear: "결과 초기화"
  },
  en: {
    title: "Seat Picker",
    btnName: "Pick by Name",
    btnNumber: "Pick by Number",
    btnLotto: "Lottery",
    btnWheel: "Wheel",
    btnRange: "Range Groups",
    lblNames: "Name list (comma separated)",
    lblGroupCountName: "Number of groups",
    btnDrawByName: "Draw by Name",
    lblCount: "Total participants",
    lblGroupCount: "Number of groups",
    btnDrawByNumber: "Draw by Number",
    lblLottoCount: "Total participants for lottery",
    lblLottoDraw: "How many to pick?",
    btnDrawLotto: "Draw Lottery",
    lblWheelInput: "Names (comma separated) or number count",
    btnSpinWheel: "🎡 Spin Wheel",
    lblTotalCount: "Total participants",
    lblRangeGroupCount: "Number of groups",
    lblRangeOne: "Range 1 (ex: 1-8)",
    lblRangeTwo: "Range 2 (ex: 9-17)",
    btnDrawByRange: "Draw Range Groups",
    btnClear: "Clear Results"
  }
};

function setLanguage(lang) {
  const t = translations[lang];
  for (const key in t) {
    const el = document.getElementById(key);
    if (el) {
      if (el.tagName === 'INPUT') {
        el.placeholder = t[key];
      } else {
        el.textContent = t[key];
      }
    }
  }
}
function setMode(mode) {
  ['name', 'number', 'lotto', 'wheel', 'range'].forEach(id => {
    const el = document.getElementById(id + 'Mode');
    if (el) el.classList.add('hidden');
  });
  const show = document.getElementById(mode + 'Mode');
  if (show) show.classList.remove('hidden');
  clearResult();
  if (mode === 'wheel') {
    const input = document.getElementById('wheelInput');
    if (!input.value.trim()) input.value = '4';
    parseWheelInput();
  }
}

function shuffle(arr) {
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
}

function drawByName() {
  const names = document.getElementById('names').value.split(',').map(n => n.trim()).filter(n => n);
  const groupCount = parseInt(document.getElementById('groupCountName').value);
  const result = document.getElementById('result');
  result.innerHTML = '';
  if (!names.length || !groupCount || groupCount <= 0) return;
  shuffle(names);
  const groups = Array.from({ length: groupCount }, () => []);
  names.forEach((name, i) => groups[i % groupCount].push(name));
  groups.forEach((group, i) => {
    const div = document.createElement('div');
    div.className = 'group';
    div.innerHTML = `<strong>${i + 1}모둠</strong>` + group.map(n => `<span>${n}</span>`).join(' ');
    result.appendChild(div);
  });
}

function drawByNumber() {
  const count = parseInt(document.getElementById('count').value);
  const groupCount = parseInt(document.getElementById('groupCount').value);
  const result = document.getElementById('result');
  result.innerHTML = '';
  if (!count || !groupCount || groupCount <= 0 || count < groupCount) return;
  let list = Array.from({ length: count }, (_, i) => `${i + 1}`);
  shuffle(list);
  const base = Math.floor(count / groupCount);
  const rest = count % groupCount;
  const groups = Array.from({ length: groupCount }, () => []);
  let idx = 0;
  for (let i = 0; i < groupCount; i++) {
    for (let j = 0; j < base; j++) groups[i].push(list[idx++]);
  }
  for (let i = 0; i < rest; i++) {
    groups[groupCount - 1].push(list[idx++]);
  }
  groups.forEach((group, i) => {
    const div = document.createElement('div');
    div.className = 'group';
    div.innerHTML = `<strong>${i + 1}모둠</strong>` + group.map(n => `<span>${n}번</span>`).join(' ');
    result.appendChild(div);
  });
}

function drawLotto() {
  const total = parseInt(document.getElementById('lottoCount').value);
  const pickCount = parseInt(document.getElementById('lottoDraw').value);
  const result = document.getElementById('result');
  result.innerHTML = '';
  if (!total || !pickCount || total < pickCount) return;
  let list = Array.from({ length: total }, (_, i) => `${i + 1}`);
  shuffle(list);
  const picks = list.slice(0, pickCount);
  const box = document.createElement('div');
  box.className = 'group';
  picks.forEach(num => {
    const item = document.createElement('span');
    item.textContent = `${num}번`;
    box.appendChild(item);
  });
  result.appendChild(box);
}

let wheelItems = [];
let rotation = 0;
let isSpinning = false;
let spinVelocity = 0;

function parseWheelInput() {
  const input = document.getElementById('wheelInput').value.trim();
  if (!input) return;
  if (/^\d+$/.test(input)) {
    wheelItems = Array.from({ length: parseInt(input) }, (_, i) => `${i + 1}`);
  } else {
    wheelItems = input.split(',').map(x => x.trim()).filter(x => x);
  }
  drawWheel();
}

function getSelectedIndexFromRotation(rotation, count) {
  const arc = 2 * Math.PI / count;
  const pointerAngle = ((-Math.PI / 2 - rotation) % (2 * Math.PI) + 2 * Math.PI) % (2 * Math.PI);
  let index = Math.floor(pointerAngle / arc);
  return index;
}

function drawWheel() {
  const canvas = document.getElementById('wheelCanvas');
  if (!canvas) return;
  const ctx = canvas.getContext('2d');
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  const count = wheelItems.length;
  if (count < 2) return;
  const centerX = canvas.width / 2;
  const centerY = canvas.height / 2;
  const arc = 2 * Math.PI / count;
  const radius = 140;
  const selectedIndex = getSelectedIndexFromRotation(rotation, count);
  wheelItems.forEach((item, i) => {
    const angle = i * arc;
    ctx.beginPath();
    ctx.moveTo(centerX, centerY);
    ctx.arc(centerX, centerY, radius, angle + rotation, angle + arc + rotation);
    ctx.closePath();
    ctx.fillStyle = `hsl(${i * 360 / count}, 80%, 70%)`;
    ctx.fill();
    if (i === selectedIndex) {
      ctx.strokeStyle = 'red';
      ctx.lineWidth = 4;
      ctx.stroke();
    }
    ctx.save();
    ctx.translate(centerX, centerY);
    ctx.rotate(angle + arc / 2 + rotation);
    ctx.textAlign = 'right';
    ctx.fillStyle = '#111';
    ctx.font = '14px sans-serif';
    ctx.fillText(item, radius - 10, 5);
    ctx.restore();
  });
}

function spinWheel() {
  if (wheelItems.length < 2 || isSpinning) return;
  spinVelocity = 0.4 + Math.random() * 0.5;
  isSpinning = true;
  requestAnimationFrame(animateSpin);
}

function animateSpin() {
  if (!isSpinning) return;
  rotation += spinVelocity;
  spinVelocity *= 0.985;
  drawWheel();
  if (spinVelocity < 0.002) {
    isSpinning = false;
    const selectedIndex = getSelectedIndexFromRotation(rotation, wheelItems.length);
    const winner = wheelItems[selectedIndex];
    document.getElementById('wheelResult').innerText = winner
      ? `🎉 당첨: ${winner}`
      : '🎉 당첨: (선택 불가)';
  } else {
    requestAnimationFrame(animateSpin);
  }
}

function drawByRange() {
  const total = parseInt(document.getElementById('totalCount').value);
  const groupCount = parseInt(document.getElementById('rangeGroupCount').value);
  const input1 = document.getElementById('rangeOne').value.trim();
  const input2 = document.getElementById('rangeTwo').value.trim();
  const result = document.getElementById('result');
  result.innerHTML = '';

  if (!total || !groupCount || !input1 || !input2) return;

  function parseRange(input) {
    if (/^\d+\s*-\s*\d+$/.test(input)) {
      const [start, end] = input.split('-').map(Number);
      return Array.from({ length: end - start + 1 }, (_, i) => (start + i).toString());
    } else {
      return input.split(',').map(x => x.trim()).filter(x => x);
    }
  }

  let range1 = parseRange(input1);
  let range2 = parseRange(input2);
  shuffle(range1);
  shuffle(range2);

  const groups = Array.from({ length: groupCount }, () => []);
  for (let i = 0; i < groupCount; i++) {
    if (range1.length) groups[i].push(range1.pop());
    if (range2.length) groups[i].push(range2.pop());
  }

  const remaining = range1.concat(range2);
  groups[groups.length - 1] = groups[groups.length - 1].concat(remaining);

  groups.forEach((group, i) => {
    const div = document.createElement('div');
    div.className = 'group';
    div.innerHTML = `<strong>${i + 1}모둠</strong>` + group.map(n => `<span>${n}</span>`).join(' ');
    result.appendChild(div);
  });
}


function clearResult() {
  document.getElementById('result').innerHTML = '';
  const wheelResult = document.getElementById('wheelResult');
  if (wheelResult) wheelResult.innerText = '';
  rotation = 0;
}
</script>
</body>
</html>
